(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f04718"],{7826:function(t,e,n){},"9ed6":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-nav-bar",{attrs:{title:"登录"},scopedSlots:t._u([{key:"left",fn:function(){return[n("van-icon",{attrs:{name:"cross"},on:{click:function(e){return t.$router.back()}}})]},proxy:!0}])}),n("van-form",{ref:"loginFrom",on:{submit:t.onSubmit}},[n("van-field",{attrs:{name:"mobile",placeholder:"请输入手机号",rules:t.userRules.mobile,type:"number",maxlength:"11"},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}},[n("template",{slot:"left-icon"},[n("i",{staticClass:"toutiao toutiao-shouji"})])],2),n("van-field",{attrs:{name:"code",placeholder:"请输入密码",rules:t.userRules.code,type:"number",maxlength:"6"},scopedSlots:t._u([{key:"button",fn:function(){return[t.isCountDownShow?n("van-count-down",{staticClass:"Yanzheng",attrs:{time:6e4,format:"ss s后可重新发送"},on:{finish:t.finish}}):n("van-button",{staticClass:"YanZheng",attrs:{round:"",type:"default","native-type":"button"},on:{click:t.onSendSms}},[n("span",[t._v("获取验证码")])])]},proxy:!0}]),model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}},[n("template",{slot:"left-icon"},[n("i",{staticClass:"toutiao toutiao-yanzhengma"})])],2),n("div",{staticStyle:{margin:"16px"}},[n("van-button",{attrs:{block:"",type:"info","native-type":"submit"}},[t._v(" 提交 ")])],1)],1)],1)},a=[],o=(n("96cf"),n("1da1")),u=n("c24f"),s=n("4360"),i={name:"LoginIndex",data:function(){return{user:{mobile:13911111111,code:246810},userRules:{mobile:[{required:!0,message:"手机号不能为空"},{pattern:/^[1][3,4,5,7,8][0-9]{9}$/,message:"手机格式不符"}],code:[{required:!0,message:"验证码不能为空"},{pattern:/^\d{6}$/,message:"验证码格式不符"}]},isCountDownShow:!1}},methods:{onSubmit:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),t.prev=1,t.next=4,Object(u["f"])(e.user);case 4:n=t.sent,e.$toast.success("登录成功"),r=n.data.data,s["a"].commit("setUser",r),e.$router.back(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),400===t.t0.response.status?e.$toast.fail("手机格式或验证码错误"):e.$toast.fail("登录失败,请稍后重试");case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))()},onSendSms:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.loginFrom.validate("mobile");case 3:t.isCountDownShow=!0,e.next=9;break;case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",t.$toast.fail(e.t0.message));case 9:return e.prev=9,e.next=12,Object(u["g"])(t.user.mobile);case 12:e.next=17;break;case 14:e.prev=14,e.t1=e["catch"](9),429===e.t1.response.status?t.$toast.fail("发送太频繁"):t.$toast.fail("发送失败");case 17:case"end":return e.stop()}}),e,null,[[0,6],[9,14]])})))()},finish:function(){this.isCountDownShow=!1}}},c=i,l=(n("c03b"),n("2877")),f=Object(l["a"])(c,r,a,!1,null,"6a920bf4",null);e["default"]=f.exports},c03b:function(t,e,n){"use strict";var r=n("7826"),a=n.n(r);a.a},c24f:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"i",(function(){return f})),n.d(e,"h",(function(){return d}));var r=n("b775");function a(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/authorizations",data:t})}function o(t){return Object(r["a"])({method:"get",url:"/app/v1_0/sms/codes/".concat(t)})}function u(){return Object(r["a"])({method:"get",url:"/app/v1_0/user"})}function s(){return Object(r["a"])({method:"get",url:"/app/v1_0/user/channels"})}function i(t){return Object(r["a"])({method:"post",url:"/app/v1_0/user/followings",data:{target:t}})}function c(t){return Object(r["a"])({method:"delete",url:"/app/v1_0/user/followings/".concat(t)})}function l(){return Object(r["a"])({method:"get",url:"/app/v1_0/user/profile"})}function f(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})}function d(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})}}}]);